import React, { useEffect, useMemo, useRef, useState } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import './CodexReader.css';

export default function CodexReader() {
    const nav = useNavigate();
    const { search } = useLocation();
    const params = new URLSearchParams(search);
    const initialCh = Math.max(0, parseInt(params.get('ch') ?? '0', 10));
    const initialSec = Math.max(0, parseInt(params.get('sec') ?? '0', 10));
    const initialPage = Math.max(0, parseInt(params.get('page') ?? '0', 10));

    const chapters = useMemo(() => ([
        {
            title: '一 ｜ 地下',
            sections: [
                {
                    name: '로비',
                    pages: [
                        '복도 끝에서부터 일정한 간격의 발소리가 난다. 멈추면 같이 멈춘다.'
                    ],
                },
                {
                    name: '백스테이지',
                    pages: [
                        '조명이 꺼져 있을 때만 보이는 경로 표시가 있다. 불을 끄면 문이 가까워진다.'
                    ],
                },
                {
                    name: '라이브 스테이지',
                    pages: [
                        '관객석은 비어 있으나 무대 위 마이크가 호흡을 센다. “하나, 둘…”'
                    ],
                },
            ],
        },
        {
            title: '二 ｜ 1階',
            sections: [
                {
                    name: '로비',
                    pages: [
                        '안내 데스크 위 명패의 이름은 네가 생각한 것과 다르다. 그 이름을 말하지 말 것.'
                    ],
                },
                {
                    name: '카페 시나몬',
                    pages: [
                        '메뉴판 마지막 줄이 깜빡인다. 보이는 대로 주문하지 말고, 네가 본 대로 주문하라.'
                    ],
                },
            ],
        },
        {
            title: '三 ｜ 5階',
            sections: [
                {
                    name: '배움터',
                    pages: [
                        '칠판에는 아무것도 적히지 않았지만, 지워지는 소리가 난다.'
                    ],
                },
                {
                    name: '대도구실',
                    pages: [
                        '문짝은 하나인데 경첩은 둘이다. 하나는 너를 위해 존재하지 않는다.',
                    ],
                },
            ],
        },
        {
            title: '四 ｜ 6階',
            sections: [
                { name: '의상룸', pages: ['옷걸이가 귓속말을 한다. “네가 고른 건 아니야.”'] },
            ],
        },
        {
            title: '五 ｜ 7階',
            sections: [
                { name: 'NEW DIMENSION', pages: ['창 없는 방에서만 빛이 새어 나온다.'] },
                { name: '의무실', pages: ['대기번호는 항상 네 앞이다. 그러나 불리면 뒤를 본다.'] },
            ],
        },
        {
            title: '六 ｜ 8階',
            sections: [
                { name: '녹화부스', pages: ['마이크 테스트 음성이 다시 녹음 위로 올라탄다.'] },
                { name: '보컬룸', pages: ['고음에서 유리가 웃는다. 네가 먼저 내려와라.'] },
                { name: '샤워룸', pages: ['서리 위 글자는 “여기”가 아니라 “거기”.'] },
                { name: '연주스튜디오', pages: ['박자가 맞아떨어지면 누군가 한 명은 사라진다.'] },
                { name: '간이스튜디오', pages: ['3분 이상 녹음된 것은 되감을 수 없다.'] },
            ],
        },
        {
            title: '七 ｜ 9階',
            sections: [{ name: '댄스룸 밀집구역', pages: [
`1. 레슨룸에 접근하는 경우, 내부에서는 격한 춤사위에 따른 『쿵쿵거림』이 감지될 수 있습니다.
그러나 내부에 실제 인원이 존재하지 않는 사례가 보고되었으므로 주의가 필요합니다.
1-1. 내부를 확인하려는 경우, 반드시 귀하 본인의 정신이 손상되지 않도록 스스로를 보호하십시오.
　　- 정상적인 인식을 유지할 경우, 해당 음향의 비정상성을 인지하고 접근을 자제하시기 바랍니다.
1-1-1. 그러나 현실 감각이 흐려진 경우, 현재 상황을 『일상』으로 오인하며 예정된 레슨에 참가하려는 강한 충동이 발생합니다.
1-1-2. 항목 1-1-1의 상태(이하 『일상』 상태로 명명)는 특정 조건 하에 해제되는 것으로 파악되나, 아직 완벽히 해소 방안이 발견되지 않은 상태입니다. 현재 해당 상태에서 해소된 인원에 관련한 연구가 진행되고 있습니다.
1-1-3. 『일상』 상태의 인원을 목격한 경우, 가능한 모든 힘을 동원하여 진입을 저지하십시오. 설득·제압·물리적 제지 등 가능한 모든 수단을 사용해 귀하 본인과 타인의 생존을 확보하시기 바랍니다. 물리적 저지 과정에서 대상에게 일정 수준 이상의 고통을 가한 경우, 대상이 현실 감각을 되찾을 가능성이 있습니다.
1-2. 『일상』 상태 인원이 레슨룸 내부에 진입하면, 다음의 절차가 진행됩니다.
1) 문이 개방됨과 동시에 천장에서 나타난 검은 형상이 대상의 머리를 삼킵니다.
2) 대상은 즉시 사망하며, 시신은 내부에 고립됩니다.
3) 문은 자동으로 폐쇄되며, 불이 꺼집니다.

본 방식으로 ■■호실 폐쇄, 이후 해당 레슨룸에 재진입 성공한 사례 보고되지 않음.

1-3. 레슨룸에 대한 무분별한 접근은 귀하의 활동 지속 가능성을 심각하게 저해합니다. 최근 보고서에 따르면 『일상』 상태에서의 진입 사례 중 대다수가 영구적인 손실(신체적·정신적)로 이어졌으므로, 상황이 강제되지 않는 한 진입을 삼가시기 바랍니다.
1-3-1. 단, 본 지침서를 발견한 귀하께서는 이미 위험 구역으로의 침입을 강행하신 것으로 파악됩니다. 모든 수단과 방법을 동원하여 귀하의 정신을 보호하십시오.
1-3-2. 단, 특정 목적(예: 레슨룸에서 사망한 유닛원의 최후 목격, 자료 회수 등)을 위해 진입을 결정하는 경우, 귀하께서는 해당 결과에 대한 전적인 책임을 부담하게 됩니다. 본 절차는 일반적으로 권장되지 않으며, 가급적 긴급 상황에서만 수행하시기 바랍니다.

2. 낮은 확률로, 복도 내 특정을 조사한 일부 인원은 『비명소리』가 지속적으로 감지되었다고 보고하였습니다. 비명소리는 주로 “살려주세요”, “나, 여기서 나갈래. 나가게 해 줘” 등의 단어로 구성되어 있으며, 간헐적으로 절규가 섞여 들려왔다는 진술도 존재합니다.
2-1. 음성의 반복성이 확인된 사례가 다수 보고되었습니다. 특히 동일한 문구가 끊임없이 재생되는 현상은 귀하의 인지 체계를 교란시켜, 현실과 반복 구조를 구분하는 능력을 서서히 손상시킬 수 있습니다. 일부 연구자들은 해당 현상이 고장난 방송 장치와 유사하다고 지적하였으나, 물리적 원인을 확인한 사례는 없습니다.
2-2. 해당 구역을 조사하는 경우, 해당 위치에서 장시간 체류하지 않도록 주의하십시오. 일부 사례에서는 이후 장기간에 걸쳐 불안·환청·집중력 저하와 같은 정신적 손상 징후가 관찰되었습니다. 몇몇 경우는 이를 단순한 기분 문제로 치부하였으나, 증상이 수 개월 이상 지속된 경우가 확인되었습니다.
2-2-1. 단기간 내 이탈이 불가능한 경우, 청각 차단을 포함한 가능한 모든 조치를 취하여 음성을 피하십시오. 귀하의 ‘정신’을 보존하기 위한 행동은 즉시 실행되어야 하며, 이를 미루는 것은 치명적인 결과를 초래할 수 있습니다.
2-2-2. 내부 진입을 시도하는 경우, 문은 무음 상태로 개방되며, 동시에 모든 비명이 멈춥니다. 이때, 귀하의 체온이 순간적으로 하락하거나, 등골을 타고 전해지는 냉감을 느낄 수 있습니다. 이는 고립된 내부 환경에 노출되었음을 알리는 신호로 해석됩니다.
2-2-3. 내부에 발을 들인 인원 중 최초 진입자에게서는 이후 지속적으로 사소한 불운이 보고되었습니다. 물건을 자주 떨어뜨리거나, 걸음을 옮길 때마다 균형을 잃는 등 작은 사고가 잦아지는 경향이 있으며, 본인은 이를 ‘기분 탓’이라 설명하는 경우가 많습니다. 그러나 이러한 패턴은 평균적으로 수주 이상 지속되는 것으로 확인되었습니다.
2-2-4. 매우 드물게 해당 구역 진입 직후 출구가 완전히 봉쇄되는 사례가 보고되었습니다. 이 경우, 다음 중 하나의 절차를 신속히 수행하십시오.
- 총기류를 소지한 경우: 탄환을 귀하의 두개골에 직접 사용하십시오. 추천되는 부위는 관자놀이 또는 경동맥으로, 단일 발사로 즉시 사망이 가능한 지점입니다.
- 둔기(혹은 도검)를 보유한 경우: 가능한 최대의 힘으로 귀하의 두개골을 타격하십시오.
- 아무 도구도 보유하지 않았거나 사용이 불가능한 경우: 귀하의 치아로 혀를 절단하는 시도를 하실 수 있으나, 즉각적인 사망을 보장하지 않습니다. 단, 쇼크로 사망한 가능성은 몇 차례 보고되었습니다.
- 어떠한 물리적인 시도도 불가능한 경우: 그것들이 빠르게 귀하에 대한 흥미를 잃기를 기도하십시오.
2-3.『비명소리 구역』은 그 특성상 직접적인 신체 손상보다는 장기적·누적적 피해를 유발하는 환경입니다. 따라서 단기 체류 시에도 주의가 필요하며, 장기 노출은 권장하지 않습니다.
2-4. 본 항목은 9층의 전 지역에 있어 대체로 통용되나, 특히나 해당 구역은 재조사 및 재진입에 따른 정보의 이득이 거의 없습니다.
2-4-1. 부득이하게 본 구역에 재진입하는 경우, 귀하 스스로 청각 보호 장치를 준비하고, 동료와의 시각적 신호 체계를 미리 합의하십시오.

3. 해당 구역에서는 규칙적이지 않은 간격으로 『말소리』가 들립니다.
3-1. 음성의 출처는 특정 방향으로 고정되지 않고, 귀하가 움직이는 위치에 따라 변합니다.
3-2. 들리는 목소리의 정체에 따라 다음 조항을 참고하여 행동하십시오.
3-2-1. 모르는 목소리: 일단 안심하셔도 좋습니다. 다만 방심은 금물입니다.
3-2-2. 아는 목소리: 귀하께서 최근 접촉한 인물·장소·사건과 관련성이 높습니다.
3-2-3. 음성을 집중하여 해석하려는 행위는 권장되지 않습니다. 장시간 청취를 시도한 인원은 이후 현실에서 발생하지 않은 대화를 ‘실제로 나눈 적이 있다’고 주장하였습니다.
3-3. 본 구역에 장시간 머무를 경우, 귀하의 정신에 누적적인 영향을 미칠 수 있습니다.
3-3-1. 특히 익숙한 이름이나 별칭을 들었을 경우, 발언의 출처를 확인하려는 강한 충동이 발생합니다.
3-4. 원인은 현재까지 규명되지 않았습니다. 일부 장비를 이용한 녹음 시도는 모두 데이터가 소실되었습니다.
3-4-1. 공통점: 귀하가 들은 말소리가 다른 사람에게는 들리지 않습니다.
3-5. 말소리는 심리적 교란을 주요 피해 요인으로 삼습니다.
3-5-1. 동료와 함께 이동 시, 서로의 상태를 수시로 점검하십시오.

4. 외부 복도 속 절대적 정적의 공간이 있습니다. 문을 닫으면 외부의 소리가 차단되며 잠시 안정을 찾을 수 있습니다.
그러나 내부에는 음향기기, 전신 거울, 접이식 의자 등이 있으며, 특정 대상과의 접촉은 심각한 위해를 초래할 수 있습니다.
4-1. 음향기기: 작동 시 금속 부품이 덜컥이는 소리가 들립니다. 이후 재생되는 소리는 귀하가 이해 가능한 발언으로 확인됩니다.
4-2. 전신 거울: 낮은 확률로 귀하가 아닌 다른 인물이 비칠 수 있습니다. 그는 무언가를 전하려 하지만 목소리는 들리지 않습니다.
4-2.1. 표면을 건드리면 왜곡이 생기고, 거울 너머의 인물이 손목을 붙잡아 끌어당깁니다.
눈을 뜨면, 귀하는 거울 너머의 세계로 이동됩니다. 이곳에서는 어떠한 음성도 발현되지 않으며, 몸짓만이 유일한 의사소통 수단입니다.
4-2-2. 접이식 의자로 거울을 파괴할 수 있으나, 이후 발생하는 문제점은 파악되지 않았습니다.`
        ] }],
        },
        {
            title: '八 ｜ 10階',
            sections: [
                { name: '미팅룸', pages: ['의자 개수는 사람 수보다 하나 많다. 남는 자리에 앉지 마라.'] },
                { name: '사원식당', pages: [
        `1. 해당 공간 조사에는 직원용 출입카드의 소지가 권장됩니다. 출입증 보유 여부를 확인해 주십시오. 귀하께서 출입증을 소지하지 않은 상태였다고 하더라도 낮은 확률로 바지 주머니에서 출입증이 발견될 것입니다.

출입증이 없는 상태로 사원식당에 진입한 것으로 추정되는 직원 A가 아직까지 발견되지 않고 있음, 이후에 내부 조사한 직원 B는 노른자 부분이 A의 눈동자 색과 동일한 계란 프라이를 발견했음, 진짜 A의 눈동자인지 확실히 밝혀지지 않았으나 주의할 것. 
현재 2의 항목에 기반하여 출입증 없이도 진입이 가능함을 확인함.

2. 내부를 안전하게 조사하고 싶다면 귀하께서는 두 가지의 선택지가 존재합니다. 음식을 주문하지 않고 진입할 경우에 대해서는 알려진 바가 없으므로, 이하 내용을 참고하여 귀하께 적절한 방법을 이용하여 주십시오.

2-1. 직원용 출입카드 이용
식사 전후로 바코드를 찍으면 직원임이 인식돼 한 달 뒤에 처리되는 방식이므로 귀하께서 당장 음식 값을 지불하실 필요는 없습니다. 특히나 귀하께서 식사가 제공되는 성주관에 거주 중일 경우는 더더욱 음식 값을 상정하실 필요가 없으나, 해당 사항은 일반 상식이 통할 때의 상황이므로 지금은 특수 개체 『셰프』가 불시에 『음식 값』을 요구할 것까지 고려해야 합니다. 따라서 가급적 저렴한 메뉴를 골라주십시오.

2-1-1. 후술하겠으나 이곳에서의 음식 값은 단순히 엔화나 릿달러가 아닙니다. 귀하께서 정상적인 음식 값을 지불할 능력이 충분함은 알고 있으나, 이곳에서는 가능한 한 저렴한 음식을 구매해 주시길 바랍니다.

2-1-2. 타인의 카드를 도용했을 경우의 상황에 대해서는 밝혀진 바가 없으니 각별히 주의하여 주십시오.

ㄴ 이 경우, 옆에서 살피던 직원이 카드 보유자 본인이 확실하냐고 물어봄. 두 번 물어봄.
중간에 한 번이라도 자기 것이 아니라고 할 경우 카드와 함께 카드를 쥔 손이 잘려나가는 수준으로 끝나나, 끝까지 자기 것이라고 하면 직원이 억지로 팔을 잡고 조리실로 끌고 감. 사흘 후 식당에 다시 들어오면 특별 메뉴인 『(캐릭터 이름) 정식』을 볼 수 있습니다.
ㄴ 단, 2wink의 경우 직원이 구분을 못한단 설정이므로 카드를 도용해도 봐줄 것.

2-2. 식권 이용
신체의 일부를 대가로 직원을 통하여 식권을 구매할 수 있습니다. 진열되어 있는 음식 모형 중 원하는 것을 가리키며 주문하면 직원이 식권을 내어주며 조리를 준비할 것입니다. 또한, 음식 값으로 당신의 『무언가』 가 요구됩니다. 

2-2-1. 해당 가격은 그들의 판단에 따라 임의로 선택됩니다.

2-2-2. 직원 개체의 대다수는 출혈 없이 애초에 해당 신체 부위가 없던 것처럼 깔끔하게 잘라가는 기술이 있는 것으로 판단됩니다.

2-2-3. 만약 해당 부위가 당신에게 꼭 필요한 신체부위로 판단된다면, 가격을 최대 2회까지 흥정할 수 있으나 성공 확률보다 실패 확률이 높습니다.
- 실패의 경우, 신체부위를 빼앗긴 채 가게에서 쫓겨날 가능성이 있습니다.
- 또한 데스크 직원은 다소 참을성이 없는 개체로 나타났습니다. 3회 이상 흥정할 경우 데스크 직원이 당신의 해당 신체부위 위치에 아무 『메뉴』를 끼워 『반환』할 수 있으므로 귀하의 합리적인 판단을 요합니다.

- 리즈링 직원 C의 경우, 고로케 값으로 손가락 2개를 요구당한 것은 과한 처사라며 직원과 오랜 시간 실랑이를 하였다는 증언이 나옴. 24분 가량의 실랑이 후, 직원은 질린다는 표정으로 C의 손가락이 있던 자리에 고구마 튀김을 내리꽂아 신체 일부처럼 연결함. 해당 조사 다음 날 C의 손가락을 보니 혈관이 자색 고구마 살점 사이사이를 뚫고 튀김의 섬유질 속에 미세하게 얽혀 들어가, 뿌리채 흡수하듯 고구마 튀김과 순환하고 있음을 확인. C군은 손가락을 움직이는 감각으로 고구마 튀김을 움직일 수 있음.

ㄴ 4일차 이후에 조사할 경우 식당 한켠에 오늘의 메뉴로 『C군 정식』이 추가됨.
『C군(가명) 定食 – 백반, 고구마 튀김, 생간, 검고 생기있는 안구, (어른의 사정에 의해 기재할 수 없습니다), 영혼』
※ 고객님의 사연이 담긴 특별 한정 메뉴입니다.

3. 메뉴 선정에 있어서는 최대한 값싼 메뉴를 권장합니다. 값비싼 메뉴의 경우 요구되는 『음식 값』을 지불하기 어려워지므로 양해 바랍니다.

또한 식당의 직원들은 당신이 식당 내에서 비명을 지를 상황을 달가워하지도 않을 것이므로 유의해 주십시오. 

3-1. 특히 값비싼 일부 메뉴의 경우, 7~10층에서 사망한 인원의 유해 일부가 발견되는 상황이 나타났으므로 추천하지 않습니다.

3-1-1. 만약 반드시 유해를 수집해야 하는 대상이 있을 경우 귀하께서 해당 유해의 회수를 위해 값비싼 메뉴를 주문하실 수 있을 것으로 파악됩니다. 이와 같은 행위는 일반적으로 권장되지 않으나, 상황에 따라 적절하게 이용해 주십시오.
ㄴ 단, 최초 방문 시 지침서가 채워지지 않아서 메뉴 값은 알 수 없음.

4. 일부 확률로 특수 개체가 출연합니다.

4-1. 『만담꾼』: 남성, 신장 약 175cm, 갈색 염색모, 20대 중반 추정, 웃는 상.
해당 개체가 말을 걸어오며 합석을 제안할 수 있습니다.
만담꾼은 자신의 대화를 무시하는 이에게 너그럽지 않은 태도를 보이므로, 부디 합석을 거절하거나 그의 말을 무시하지 마시되 경청하지도 마십시오.

4-1-2. 귀하의 일행이 2인 이상일 경우 그를 무시하는 것이 비교적 쉬울 것입니다. 고개를 끄덕이거나 『그렇군요.』 등의 대답을 하여 공감의 의사를 표현하십시오. 단, 해당 대화를 경청하려 시도하지 마십시오. 어차피 귀하께서 이해하실 수 없습니다.
(만담꾼이 말을 걸어올 경우 듣는 사람들은 정신력 판정의 ‘실패’를 요구함. 성공 시 깊은 인지 혼란. 나 여기 뭐하러 왔지? 이 사람이랑 좀 더 대화해볼 수는 없나?)

4-1-2. 귀하께서 단독으로 진입 후 해당 개체와 마주치셨을 경우, 차라리 도주하시는 편을 추천 드립니다.

코즈프로 소속 아이돌 R군은 사원식당 앞을 배회하던 중, 식당 앞에 존재하는 비상주 개체 ‘만담꾼’의 제안에 단독으로 합석함. 만담꾼은 일반적인 직원처럼 행동하며, 자연스럽게 일상 대화와 유머를 섞어 이야기하였으나, 대화 상대를 괴이의 영역에 ‘익숙한 인물’로 인식하도록 유도한 것으로 추정됨.

R군은 약 75분간 만담꾼과 대화를 나눈 뒤 현실과 괴이 간의 경계를 혼동하는 징후를 보이기 시작함.
현재 R군은 완전히 괴이에 잡아먹힌 상태는 아닌 것으로 보이나, 건물 내 이상징후를 인지하지 못한 채 자주 다니던 공간을 배회하고 있으며, 본인 스스로는 “조만간 있을 컴백을 위한 준비”를 한다고 인식하는 듯함.

4-2. 『셰프』: 외관과 무관하게 흰 가운을 입고 있음
얘는 뭐 하지

4-2.1.

4-2.2.

5. 식사를 마친 경우 귀하께서는 낮은 확률로 『카페 시나몬 무료 시식권』을 제공받을 수 있습니다.
해당 확률은 음식의 가격과 비례하는 것으로 추정됩니다.`
        ] },
            ],
        },
        {
            title: '九 ｜ 12階',
            sections: [
                { name: 'RHYTHM LINK', pages: [
        `리즈링에서는 특정한 행위가 존재하기 전까지 안전하다고 파악됨.

1. 컴퓨터가 켜져 있으면 절대 들여다보지 마시오. 그것은 당신에게 해가 될 내용을 가감없이 보여줌. 만일 이미 모니터를 확인하였다면 귀하의 정신이 멀쩡하기를 바라지.
2. 모니터에 도착하는 메일은 매번 다르며, 현재까지 파악된 것은 아래와 같음.
(1) 외부 로케 제의
(2) 영화 출연 제의
(3) 굿즈 제작 관련 문의

2.1. 외부 로케 내용은 수락 시 일상에서 아이돌 활동을 이어할 수 잇다는 것을 명시하고 잇으며, 이 방법을 통하여 기존의 비일상을 탈출하여 일상에 진입이 가능함을 어필함. 하지만 이를 받아들이면 es 건물 외부로 나가게 되며, 이는 1층의 정문을 통해 바깥으로 나간 것과 같은 양상이 펼쳐짐.

2.2. 영화출연 제의. 가장 문제. 해당 메일을 열면 그 즉시 지하 공동 전체가 어느 극단의 소유에 놓이게 되며 즉시 오디션을 실시함. 이때 오디션에 응한다면 생존의 확률은 거의 0에 가까우므로 영화출연 제의에 응하려 하는 인원이 있다면 절대 말릴 것.

2.3. 굿즈 제작 관련 문의. 제목 그대로의 내용에 평소 v 유닛의 오시던 사무직 a 씨가 긍정의 내용을 회신. 이후 v 유닛의 k 군이 실종. 제작되어 도착한 굿즈의 샘플에서 k 군의 혈액을 채취할 수 있었음. 해당 인물을 그대로 굿즈로 제작한 것으로 추정.`
        ] },
                { name: '공중정원', pages: [
        `1. 공중정원 진입시 그 무엇도 손대지 않도록 주의하시오. 식물이 모두 괴이에 의해 변이되었으며, 변이된 것 중 가장 흔히 보이는 형태는 식인식물.
1.1. 식인식물은 식충식물과 같은 습성을 보임. 자신의 먹잇감이 다가오면 그것을 홀리기 위해 무엇이든 하고, 자신의 덩쿨 등을 이용하여 잡아 입 속에 넣기도 하는 모양.

2. 다수의 인원으로 진입하시오. 변이 식물은 귀하에게 쉬이 접근치 않을 것입니다.
2.1. 만일 귀하께서 홀로 진입하셨다면 유감. 죽습니다 ㅅㄱ.
2.2. 다수의 인원으로 진입하더라도 변이 식물은 그 말소리가 끊기면 사냥을 시작함. 고요 속에서는 하나쯤 사라져도 문제될 것이 없으므로.

3. 엑스트라 e 군이 공중 정원에서 약재로 쓰이는 식물을 찾았다 증언. 그러나 해당 식물 역시 변이된 상태이며, 약재로 사용할 시 그 대상을 숙주 삼아 활동을 시작하는 것으로 파악됨.`
        ] },
            ],
        },
        {
            title: '十 ｜ 15階',
            sections: [
                { name: '트레이닝룸', pages: ['러닝머신 속도는 네 심박과 협상한다. 네가 진다.'] },
                { name: '스탠드 앞', pages: ['불빛 아래 그림자가 버티면, 불을 끄고 기다려라.'] },
            ],
        },
        {
            title: '十一 ｜ 18階',
            sections: [{ name: 'COSMIC PRODUCTION', pages: ['빈 데스크에만 계약서가 놓인다. 빈 곳에 사인하지 마라.'] }],
        },
        {
            title: '十二 ｜ 19階',
            sections: [{ name: '레스팅룸', pages:  [
`잠이 먼저 오면 네가 아닌 것이 깨어난다.\n
현재 귀하께서 계신 레스팅룸은 연구 결과, 단순히 휴게용으로 이용할 경우 뚜렷한 위협 요소가 없는 것으로 확인되었습니다. 단, 해당 공간은 조사가 이루어지지 않았으므로 차후 위협이 될 요소가 발생할 수 있음에 유의 바라며, 해당 상황 발생 시 지침서를 업데이트해주시기 바랍니다.\n

1. 본 공간에 매일 생성되는 랜덤한 디저트를 통해 체력 회복 또는 개인의 능력의 상승을 유도할 수 있음을 확인하였습니다. 단, 아직 모든 디저트가 연구되지는 않았으며, 일부 디저트의 경우 영구적으로 지속되는 부작용이 있을 수 있으므로 사전에 주의 바랍니다.\n
1.1. 단, 해당 공간에서 얻을 수 있는 가장 이로운 효과는 『딸기 수플레 케이크』로 확인됩니다.\n
1-2. 발견할 수 있는 음식은 다음과 같습니다.\n
딸기 수플레 케이크 : 체력 완전 회복 후 -1\n
허니 시나몬 쿠키 : 행운+1\n
카라멜 퐁당 쇼콜라 : 관찰 -1\n
복숭아 타르트 : 체력 +3\n
크림치즈 마카롱 : 민첩 -1\n
체리 젤라또 : 행운 -1\n
망고 푸딩 : 정신력 -1\n

2. 레스팅룸은 기본 금연 및 금주입니다.\n
해당 공간에는 특별히 지켜야 할 규정이 없다고 말씀드렸으나, 이는 『일반적인 레스팅룸의 에티켓』을 준수하였을 때의 상황입니다.\n
실제로 이곳은 감시받지 않으며, 감시 장치도 존재하지 않지만 이 공간에 오래 머무른 이들은 공통적으로 이 공간이 자신의 ‘용도’와 ‘기분’을 관찰한다고 진술하였습니다.\n
귀하께서 이곳을 단순한 대화 및 휴식 공간으로 이용하고 있다면 높은 확률로 그것은 무해합니다. 그러나 그것이 이 공간을 실험실, 병실 혹은 그 외의 무엇으로 오해하기 시작할 경우, 당신의 말투와 움직임, 심지어는 마음속의 용도를 기준으로 하여 공간 자체가 구조적으로 반응할 수 있습니다.\n
2-1. 현재까지 보고된 이상 징후로는 다음과 같습니다:\n
- 햇빛과 달빛이 동시에 비추기 시작함\n
- 먹던 컵이 사라지고 대신 잔여물만 남아 있음\n
- 같은 방에 있는 사람들에게 말소리가 들리지 않음. (차후 확인 결과, 말소리가 외부로 중계된 것으로 파악됨.)\n
- 방 안에 있던 사람들 전원이 동시에 같은 사람을 상상함\n
- 수면 중 일정 비율의 체온이 반납되지 않음\n
정확한 원인은 밝혀지지 않았으며, 그에 따라 여러분 모두가 『그저 레스팅룸에서 휴식할 뿐이라는 태도』를 유지하실 것을 권장합니다.\n
이외의 목적을 부여할 경우 그 대가는 예기치 못한 방향으로 현실화될 수 있습니다.\n
만에 하나 출입구가 사라질 경우 돌이킬 수 없으므로, 저희는 귀하뿐만 아니라 귀중한 회복의 용도로 쓰일 공간을 잃지 않길 바랍니다.\n
2-2. 해당 공간에 순수한 물을 제외한 외부 음식을 반입하지 마십시오.\n
귀하께서 외부 음식을 소지하거나 반입할 경우, 이미 해당 공간 내에 있던 모든 인원은 갑작스럽고 제어 불가능한 식욕을 경험하게 됩니다.\n
귀하께서는 이미 해당 공간으로의 생존을 통해 『굶어도 특별히 식욕을 느끼지 않는다』는 사실을 깨달으셨을 것으로 판단됩니다.\n
그러나 본 항목에서 표현하는 식욕은 일반적인 배고픔과 다르며, 단순한 허기가 아닌, 미각의 심연을 찌르는 듯한 지속적 갈망이 치밀어 대부분의 사람이 저항하지 못합니다. 이는 음식을 반드시 먼저 먹어야만 한다는 강박으로 나타납니다.\n

이후의 행동은 상황에 따라 알맞는 대응 방법을 골라 수행하시면 됩니다.\n
2-1-1. 외부 음식의 섭취와 동시에 식욕이 갈무리되었을 경우, 귀하께서는 무사히 제정신을 찾으셨습니다. 명심하시면 됩니다.\n
2-1-2. 외부 음식을 섭취하였음에도 식욕이 해소되지 않았을 경우, 유감입니다. 현재 귀하의 진정한 문제는 식욕이 『외부 음식의 섭취』로 마무리되지 않았다는 점에 있습니다.\n
외부 음식이 모두 소비된 이후에도 식욕이 잔존할 경우, 귀하의 본능은 자연스럽게 눈앞의 휴게실 디저트를 향하게 되실 겁니다. 해당 시점에 이미 디저트를 모두 섭취한 상태라면 식욕은 끝없이 샘솟아 무엇이든 먹고 싶다는 환각으로 이어질 수 있습니다.\n
해당 상태는 종류를 불문하고 응접실의 디저트를 1개 이상 완전히 섭취할 때까지 지속됩니다.\n
만일 누군가가 해당 상태로 확인되며, 해당 인원이 귀하보다 물리적으로 강하고 당장 먹일 디저트가 없는 경우, 귀하께서 산 채로 먹힐 위기에 당도하기 전에 차라리 다수의 동료들과 함께 제압하시는 편을 추천 드립니다.\n
2-1-3. 2-1-2의 조항에 나타난 『식욕』은 생명체나 생명체로 착각할 수 있는 거의 모든 대상에게 발생함을 확인하였습니다.\n
동료를 뜯어먹는 것보다는 마네킹을 뜯어먹게 하는 것이 낫다고 판단할 수 있으나, 회계직원 U의 사례에 근거하여 마네킹을 취식하는 행위는 권장하지 않으므로 유의하여 주십시오.\n
귀하께서 신체 일부를 회복할 능력을 가지고 있다면 차라리 동료를 위해 신체를 내어주는 쪽이 나을 수 있습니다.\n
\n
U씨는 회계부 소속 직원으로, 정기 결산 마감 전날 장시간 야근 중 레스팅룸에서 휴게하였음. 이때 인스턴트 간편식을 들고 등장한 타 부서 직원 S군을 목격한 직후 강한 허기를 호소. 당시 레스팅룸의 디저트는 이미 전부 소진된 상태였음. U씨는 S군의 간편식을 빼앗아 섭취한 직후 S군을 기습함. 이에 S군이 방어하여 기습이 실패하자 비치된 마네킹의 손목 부위를 뜯어내어 섭취하는 행위를 함.\n
귀환 직후, 하악 및 설근 부위에 세라믹성 질감과 유사한 조직 변형이 관찰됨. 해당 부위는 피부색을 유지하나 표면에 얇은 광택층이 덮여 있어, 마네킹 표면 코팅과 유사한 반사율을 보임. 구강 내 일부 치아는 자발적으로 분리되어 사라졌으며, 치아가 있던 자리는 동일 형상의『마네킹 관절 부품』재질로 변형됨.\n
이후 약 48시간 동안 U씨는 음식이나 음료를 씹는 대신 고정된 턱 각도와 간격을 반복하며, 그 패턴은 치악에 관여하는 관절이 인위적으로 가동되는 것처럼 보였음. 이상함을 느낀 동료 직원들이 강제로 입을 열어본 결과 혀와 점막에서 미약한 플라스틱 소각 냄새가 지속적으로 감지됨. U씨는 5일간 주위 인물의 팔이나 손목을 시선으로 따라가는 습관이 생겼으며, ‘달콤하다’라는 단어를 반복 발화함. 해당 발화 시 특유의 비대칭 곡선으로 휘어 웃는 모습 관찰됨.\n

3. 디저트를 반출하지 마십시오\n
응접실 디저트는 해당 공간에서만 유효한 식재입니다.\n
이를 휴대하거나 외부로 반출할 경우, 다음과 같은 현상이 보고되었습니다:\n
- 디저트가 상하거나 증발하여 실체를 잃음\n
- 일정 시간 후, 몸속에서 디저트 냄새가 진동함\n
- 향과 맛이 피부를 통해 배출되며, 인근의 식욕을 자극함\n
- 꿈에서 같은 디저트가 나타나 섭취를 강요하는 장면이 반복됨\n
특히 같은 디저트를 두 번 이상 반출 시도할 경우, 더 이상 응접실에 해당 디저트가 생기지 않을 수 있습니다.\n
3-1. 해당 조항을 역이용하여 일부러 손해가 되는 디저트를 반출하실 분께서 계실 것으로 판단됩니다. 이렇게 될 경우 어떤 일이 발생하는지 확싫히 파악되지 않았으므로 주의해 주십시오.\n

4. 레스팅룸의 ‘기분’에 따라 구조가 변할 수 있습니다.\n
4-1. 보고된 이상 징후는 항목 2를 참고해 주세요.\n
4-2. 특히, 마네킹의 수가 늘어나거나 위치가 바뀌는 경우, 혹은 마네킹이 귀하를 비웃는 소리가 들린 경우 즉시 레스팅룸의 모든 시설을 두고 퇴실하실 것을 권고드립니다. 이는 레스팅룸이 귀하의 체류를 환영하지 않는다는 명확한 신호입니다. 위반하여 화를 입을 상황을 자처하지 마십시오.\n

5. 낮은 확률로 마네킹과 대화가 가능합니다.\n
5-1. 마네킹의 수가 방 안에 있는 인원 수보다 적을 경우, 마네킹 앞에서 3초간 눈을 마주친친 후 예의를 갖추어 마네킹과 대화를 시도하십시오. 귀하께서 충분한 운을 소지하고 계신다면 마네킹은 기꺼이 응할 것입니다.\n
5-2. 해당 과정에서 마네킹의 관절이 기괴하게 꺾이는 등의 사유로 대화를 진행하고 싶지 않는 상황이 발생할 수 있습니다. 이는 자연스러운 상황이나, 마네킹의 앞에서 표정이나 말투 등으로 귀하의 감정을 들키지 않도록 각별히 주의해 주십시오. 대화의 성공률은 귀하의 자연스러운 태도와 연관됩니다.\n
5-3. 마네킹은 높은 확률로 당신과의 대화를 거부할 수 있습니다. 대화 기회는 총 3회까지 주어집니다. 3번의 기회를 모두 소진한 이후 무리하여 대화를 시도하지 마십시오. 그것이 귀하의 존재를 고깝게 여기는 순간 귀하께서는 귀중한 체력 회복의 기회를 놓치게 됩니다.\n
5-4. 낮은 확률로 대화 기회가 남았음에도 불구하고 대화 시도 직후 마네킹 3구가 동시에 당신을 돌아볼 수 있습니다. 이 경우, 모든 대화 시도를 포기하고 레스팅룸을 떠나십시오.\n

6. 드물게 수면 중 마네킹이 본인들을 쳐다보는 것을 보았다고 주장하는 경우가 있습니다.\n
6-1. 해당 행위가 특별히 위협이 되지는 않는 것으로 사료되나, 어떤 경우라도 귀하의 육감을 맹신하십시오.\n

7. 익숙한 얼굴?`
            ] }],
        },
        {
            title: '十三 ｜ 20階',
            sections: [
                {
                    name: 'STARMAKER PRODUCTION',
                    pages: [
                        `스타메이커 프로덕션, 이하 스타프로에서는 유독 지침서의 훼손이 자주 이루어지는 것으로 판단됩니다. 하지만 그것들이 이미 작성된 글자를 수정하거나 편집하지는 못하는 것으로 판단된 바, 모든 조항의 마무리에 『당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.』를 작성해 두었습니다. 여러분의 시간은 금입니다. 출처가 불분명한 조항에 여러분의 시간을 낭비하지 마십시오.

유감스럽게도 현재 귀하께서 계신 스타프로 사무소는 다른 공간에 비해 알려진 정보가 극히 적어 여러분의 생환을 기대하기 어렵습니다. 또한 일부 인원은 출입 의사를 두는 것이 아닌, 그저 출입문에 접촉하는 것만으로도 출입으로 인식되어 내부에서 깨어나는 것으로 판단되었습니다. 이에 원인불명의 사태가 해결될 때까지 해당 공간의 접근 자체를 권장하지 않고 있습니다. 모종의 사유로 일단 입장하신 경우 당신이 만반의 준비 하에 입장하신 것이기를 빕니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

자신의 아이돌이 논란 없이 완벽한 모습만을 보이길 바라는 것은 모든 아이돌 팬의 공통 사항입니다. 임직원의 실수 또한 아이돌의 관리 태만으로 이루어질 수 있으므로 지양됩니다. 해당 문서를 열람하는 당신이 아이돌이든 직원이든, 혹은 제 3의 직종일 경우라도 해당 공간 내에서의 실수는 허락되지 않습니다. 만약 당신이 무언가의 조사를 시도하되 실패하였을 경우 그들의 눈에 띄지 않도록 최대한 빠르게 몸을 숨기십시오. 데스크 뒤나 책상 및 등, 직원들이 그 자리에서 고개를 돌렸을 때 당신의 모습이 전혀 보이지 않을 위치가 적당합니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

> 누군가 어색하게 행동하면 모든 NPC들이 해당 인물을 꼬라본단 지문 후에 3 업데이트해주시면 됩니다.

본 공간에서 성이나 이름의 직접적인 호명은 금지되어 있습니다. 실수로라도 서로의 이름을 소리내어 부르지 않도록 주의하십시오. 성이나 이름이 온전히 들어가지 않은 별칭 등으로 부르는 것은 허용됩니다. 명심하십시오. 해당 공간에서 온전한 성이나 이름을 호명하는 것은 애꿎은 희생양을 이름에 구속하는 일입니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.
3-1. 실수로 함께 조사하는 누군가의 이름을 불렀을 경우 이름이 불린 대상의 반응을 주시하십시오. 일반적으로 강한 충동에 휩싸이는 양상이 나타나는 것으로 확인되었습니다. 이 경우 무력을 써서라도 대상이 자해나 자살 시도를 하지 못하도록 말리십시오. 경우에 따라 죽게 두는 것이 낫다고 판단될 수 있으나, 시도를 계속하여 직원들의 눈에 띌 경우 직원들은 어깨를 탈골시키고 온몸을 골절시키는 한이 있더라도 상품 그 자체인 여러분이 쉬이 죽도록 허락하지 않을 것입니다. 설령 일격에 자살하기 위한 도구를 준비하였다고 하더라도, 일단 사상자가 발생하는 순간 그곳에 남은 여러분은 심문을 위해 회의실로 안내됩니다. 직원에 눈에 띄기 전에 대상을 완벽히 결박하시는 편을 추천드립니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다. 낮은 확률로 창가에 놓인 『화분』을 대상자에게 집어던질 경우 정신착란이 해소되는 모습이 확인되었으므로, 직원들의 눈길을 피해 화분을 집어던져 해결을 시도하십시오.

> 『당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.』 이후의 내용은 괴이들이 훼이크로 추가한 것. 화분을 억지로 집어던져봤자 아무것도 해결 안 되고 오히려 영구적인 상해 + 어그로만 끌려서 회의실로 끌려갈 테니 안 하는 게 맞음.
출입구를 장시간 관찰하거나 직접 손을 올려두면, 손끝의 감각이 서서히 무뎌지며 표면의 형태를 ‘익히는’ 듯한 감각이 전해집니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다. 그러나 이 감각은 귀하의 신체가 아니라 출입구 쪽이 귀하의 손을 기억하는 과정으로 보입니다.  일정 시간이 지나면, 문은 귀하의 체온·압력·맥박을 정확히 재현해내며, 귀하가 다시 돌아왔을 때 신속하게 반응하여 열리게 됩니다.일부 보고서에는 이 과정을 단축하기 위해 손을 문에 오래 대두는 것이 도움이 된다고 기록되어 있으나, 해당 보고서 작성자는 귀환하지 못했습니다.

뉴디 소속 아이돌 M군은 해당 공간에서 탈출 시도를 위해 출입문 손잡이에 접촉. 직후, 손잡이와 접촉한 손이 녹아내리며 문 표면과 융합되는 현상이 발생함. 당시 손과 문 경계가 완전히 사라져, 인체와 고정 구조물 간의 경계가 불분명해짐.

당시 M군은 심한 통증 반응을 보였으나 손잡이와의 분리가 불가능한 상태였음. 저항 시도를 기점으로 목소리가 점차 약화되었으며, 호흡·의식 반응이 소실됨. 팔의 피부색이 변색됨과 동시에 기저체온의 급격한 변화가 감지되었으며 관찰 중단됨.

사망 추정 시간 가량, 당시 20층 복도의 생존자는 M군이 피가 흐를 정도로 문에 이마를 반복적으로 박는 장면을 약 3분간 관찰했다고 보고. M군의 상태를 고려하였을 때 전신 화상 등의 가능성을 고려 중. 유해 미발견.

4-1. 손잡이에 닿은 순간, 표피는 급격히 부풀어 오르다 녹아내리며 문 표면과 융합됩니다. 이 상태에서는 어떤 도구로도 손을 떼어낼 수 없으며, 잠시 후 내부에서 발생하는 고열로 인해 근육과 뼈마저 ‘익게’ 됩니다. 극심한 작열통으로 인한 발작이 시작되기 전에, 차라리 최대한 크게 비명을 질러 그것들이 귀하를 신속히 발견·포획하도록 유도하십시오. 이 경우 고통의 지속 시간을 줄일 수 있습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

현재 응접실은 회의실로 개량되어 있습니다. 표면적으로는 평범한 집기와 설비를 갖춘 장소이나, 내부로의 진입이 확인된 인원은 전원 사망하였습니다. 사인은 일관성이 없으며, 외상 없이 쓰러진 사례부터 사지가 뒤틀린 채 발견된 사례까지 다양합니다. 일부 문서에서는 회의실 진입 후 중앙 테이블의 의자를 세 번 돌리면 안전하다고 기록되어 있으나, 해당 절차를 수행한 인원의 시신은 단 한 구도 회수되지 못했습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

본 공간에서의 탈출 방법은 단일하게 보고되었습니다. 우선 숨을 죽이는 것부터 시작하십시오. 호흡과 심박을 가능한 한 낮추고, 체온이 주변 환경과 거의 구분되지 않을 정도로 가만히 머무르십시오. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

6-1. 본 과정을 지속 중에 문손잡이가 한 번, 짧게 요동치는 순간이 발견됩니다. 그때 조용히, 그리고 단번에 밖으로 퇴장하십시오.

6-2. 일부 기록에서는 숨을 길게 내쉰 뒤 문을 세 번 두드리면 안전하게 나갈 수 있다고 제안하나, 이 절차를 시도한 인원은 다음 날 아침까지 발견되지 않았습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

드물게 정장을 입은 특수 개체를 마주칠 수 있습니다. 이 개체는 단순한 시각 접촉으로는 즉시 공격하지 않으며, 귀하의 행동을 일정 시간 관찰합니다. 귀하가 유독 일을 잘하거나, 혹은 유독 일을 못할 경우, 즉 두드러진 성과나 실패를 보일 경우 그는 조용히 다가와 귀하를 회의실로 이끌 것입니다. 일부 생존담에 따르면, 정면에서 개체의 넥타이를 세게 잡아당기면 그가 흥미를 잃고 떠난다고 기록되어 있으나, 해당 기록을 남긴 이는 이후 회의실에서 변형된 시신으로 재발견되었습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

탈출을 시도할 경우, 다음의 지침을 따르십시오.

우선 직원 한 명을 밀쳐 쓰러뜨리십시오. 직원은 평소에는 여러분을 무시하는 듯 자신의 행동만을 하지만, 신체 접촉과 동시에 균형을 잃는 순간 짧게 비명을 지를 가능성이 있습니다. 이 비명은 단순한 고통의 반응이 아니라, 회의실 깊숙이 숨어 있는 정장을 입은 개체를 호출하는 신호로 작용합니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

정장을 입은 개체가 모습을 드러내면, 그는 단 한 번도 여러분을 쳐다보지 않은 채 쓰러진 직원을 부축하여 회의실로 들어갑니다. 문이 열리는 시간은 평균 2.4초, 최장 3.1초로 보고되었습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다. 이 짧은 순간을 포착하지 못하면 문은 다시 잠기며, 다음 기회까지 최소 6시간을 기다려야 합니다

회의실 내부를 들여다본다면, 방 안에는 수십 개의 거울이 바닥부터 천장까지 배치되어 있습니다. 거울은 모두 귀하의 현재 모습을 정밀하게 반사하나, 각 거울마다 표정과 움직임이 미묘하게 어긋나 있습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

10-1. 『어긋난 모습』과 직접 눈을 마주칠 경우 즉시 심정지로 사망한다는 조사 결과가 존재합니다.

극히 낮은 확률로, 회의실 안 거울 속 귀하의 상이 인접한 유리창에 비칠 수 있습니다. 이 현상이 발생하기 전까지 과정을 반복하십시오. 단, ‘반복’이라는 행위 자체가 개체들의 흥미를 자극할 수 있으므로, 세 번 이상 시도 시 생존율이 급격히 하락한다고 보고된 바 있습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

유리창에 귀하의 거울상이 맺히는 순간, 즉시 시선을 고정하십시오. 거울상은 귀하의 모든 움직임을 따라오지만, 약 0.2초의 지연이 있습니다. 이 지연은 귀하에게 유일하게 주어진 우위이며, 잘못된 순간에 고개를 돌리면 거울상은 귀하를 모방하지 않고, 대신 창문 너머로 손을 뻗어 귀하를 끌어당길 것입니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

거울상을 주시한 채, 출입문이 있는 방향으로 천천히 이동하십시오. 달리거나 급하게 움직일 경우, 반사된 상이 제자리를 지키게 되어 절차가 중단됩니다. 이동 속도는 분당 약 6~8걸음을 넘지 않는 것이 안전하다고 보고되었습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

문 앞에 도달하면, 유리창에 비친 상이 천천히 팔을 들어 손잡이에 올릴 것입니다. 손잡이가 움직이는 순간, 귀하는 절대 눈을 깜빡여서는 안 됩니다. 일부 보고서에 따르면 이때 눈을 감았다 뜬 사람은, 같은 자리에서 문이 열리는 대신 회의실 내부의 거울 한가운데 서 있는 자신을 발견했다고 합니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

반사된 상이 문을 열면, 그 문은 한 번에 단 한 사람만을 허용합니다. 뒤따라 들어온 인원은 모두 문이 닫히는 순간 절단되며, 잘린 신체는 출입구 너머로 결코 떨어지지 않습니다. 살아남은 귀하는 즉시 출입구를 통과하고, 절대로 뒤를 돌아보지 마십시오.

15-1. 일부 경우, 회의실 바닥에 유해가 발견되었다고 보고되었습니다. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

결코 당신 자신을 잃지 마십시오. 당신이 지성체일 경우 본 조항을 반드시 숙지 바랍니다.

스타프로 소속 아이돌 A군은 스타프로 사무소 내 특정 구역에서 위협을 피하고 탈출하기 위해, 직원 신분을 가장하는 행위를 시도한 것으로 추정됨. 외부 관찰자의 진술에 따라, A군은 실제 직원들이 사용하는 동선과 행동 패턴을 정밀하게 모방했으며, 출입증 착용·서류 운반·복사기 사용 등의 행위를 반복한 것으로 파악됨.

이후 약 2시간 경과 시점부터, A군이 자신의 실제 신분에 대한 언급을 회피하고, 자신은 원래 이 사무실 직원이라고 단정적으로 판단하는 듯한 모습이 관찰됨.
해당 발언과 함께, 대화 중에 본래 자신이 아이돌임을 시사하는 발언이나 표정 변화가 전혀 없었음.

최근 관찰 보고서에서는 A군이 다른 아이돌들을 ‘직원’으로 만들기 위한 적극적 개입을 시도하고 있는 정황이 확인됨. 해당 개체의 변칙에 대한 상세한 기록이 요구됨.`,
                    ],
                },
                { name: '응접실', pages: ['차가 식기 전에 대화가 먼저 식는다. 그때 떠나라.'] },
            ],
        },
        {
            title: '十四 ｜ 屋上',
            sections: [{
                name: '헬리포트', pages: [
                    `옥상 진입 시 일정 확률로 누군가 난간 너머로 떨어지는 걸 볼 수 있음. 이때 떨어지는 인원이 익숙한 낯이라고 여러 차례 증언된 바 있으니 주의할 것.

아주 당연한 말이겠지만, 난간 너머는 추락만이 기다리고 있음. 절대 무모한 도전을 하지 마십시오.`
                ]
            }]
        },
    ]), []);

    // 상태
    const [ch, setCh] = useState(Math.min(initialCh, chapters.length - 1));
    const [sec, setSec] = useState(Math.min(initialSec, chapters[Math.min(initialCh, chapters.length - 1)].sections.length - 1));
    const [page, setPage] = useState(initialPage);

    const pages = chapters[ch].sections[sec].pages;
    useEffect(() => {
        if (page > pages.length - 1) setPage(0);
    }, [ch, sec]); // eslint-disable-line

    // URL 동기화
    useEffect(() => {
        const sp = new URLSearchParams({ ch: String(ch), sec: String(sec), page: String(page) });
        window.history.replaceState(null, '', `?${sp.toString()}`);
    }, [ch, sec, page]);

    // 넘김 로직
    const next = () => {
        if (page < pages.length - 1) return setPage(page + 1);
        if (sec < chapters[ch].sections.length - 1) {
            setSec(sec + 1); setPage(0); return;
        }
        if (ch < chapters.length - 1) {
            setCh(ch + 1); setSec(0); setPage(0); return;
        }
    };

    const prev = () => {
        if (page > 0) return setPage(page - 1);
        if (sec > 0) {
            const prevSecPages = chapters[ch].sections[sec - 1].pages.length;
            setSec(sec - 1); setPage(prevSecPages - 1); return;
        }
        if (ch > 0) {
            const prevCh = ch - 1;
            const lastSec = chapters[prevCh].sections.length - 1;
            const lastPg = chapters[prevCh].sections[lastSec].pages.length - 1;
            setCh(prevCh); setSec(lastSec); setPage(lastPg); return;
        }
    };

    // 키보드
    useEffect(() => {
        const onKey = (e) => {
            if (e.key === 'ArrowRight') next();
            if (e.key === 'ArrowLeft') prev();
            if (e.key === 'Escape') nav('/manual/mystery/codex');
        };
        window.addEventListener('keydown', onKey);
        return () => window.removeEventListener('keydown', onKey);
    }, [next, prev]); // eslint-disable-line

    // 터치: 가로 스와이프만 페이지 넘김 (세로 스크롤과 충돌 방지)
    const touchRef = useRef({ x: 0, y: 0, t: 0 });
    const onTouchStart = (e) => {
        touchRef.current = { x: e.touches[0].clientX, y: e.touches[0].clientY, t: Date.now() };
    };
    const onTouchEnd = (e) => {
        const dx = e.changedTouches[0].clientX - touchRef.current.x;
        const dy = e.changedTouches[0].clientY - touchRef.current.y;
        const dt = Date.now() - touchRef.current.t;
        if (dt < 600 && Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy)) (dx < 0 ? next : prev)();
    };

    // 빠른 이동
    const goChapter = (idx) => { setCh(idx); setSec(0); setPage(0); };
    const sectionJump = (i) => { setSec(i); setPage(0); };

    return (
        <div className="reader-wrap" onTouchStart={onTouchStart} onTouchEnd={onTouchEnd}>
            <div className="reader-frame">
                <div className="reader-head">
                    <button className="mini ghost" onClick={() => nav('/manual/mystery/codex')}>⟵ 목차</button>
                    <div className="crumb">
                        <span className="ch">{chapters[ch].title}</span>
                        <span className="sep">/</span>
                        <button className="sec" onClick={() => document.getElementById('sec-menu')?.showModal()}>
                            {chapters[ch].sections[sec].name}
                        </button>
                    </div>
                    <button className="mini" onClick={() => nav('/manual')}>지침서 메인</button>
                </div>

                {/* 섹션 점프 다이얼로그 */}
                <dialog id="sec-menu" className="sec-menu" onClick={(e) => e.target.id === 'sec-menu' && e.currentTarget.close()}>
                    <div className="sec-menu-body">
                        <h3>장소 이동</h3>
                        <ul>
                            {chapters[ch].sections.map((s, i) => (
                                <li key={i}>
                                    <button onClick={() => { sectionJump(i); document.getElementById('sec-menu')?.close(); }}>
                                        {s.name}
                                    </button>
                                </li>
                            ))}
                        </ul>
                        <button className="mini ghost close" onClick={() => document.getElementById('sec-menu')?.close()}>닫기</button>
                    </div>
                </dialog>

                {/* 페이지 영역 */}
                <div className="page-stage" key={`${ch}-${sec}-${page}`}>
                    <article className="page turn-in">
                        <header>
                            <h1>{chapters[ch].title}</h1>
                            <h2>{chapters[ch].sections[sec].name}</h2>
                        </header>

                        {/* 내부 스크롤 컨테이너 */}
                        <div className="page-content">
                            <p className="page-text">{pages[page]}</p>
                        </div>
                    </article>
                </div>

                {/* 컨트롤 */}
                <div className="controls">
                    <button className="nav-btn prev" onClick={prev} aria-label="이전 페이지">←</button>
                    <button className="nav-btn next" onClick={next} aria-label="다음 페이지">→</button>
                </div>

                {/* 하단 챕터 바 */}
                <div className="chapter-bar" role="tablist" aria-label="챕터 바로가기">
                    {chapters.map((c, i) => (
                        <button
                            key={c.title}
                            role="tab"
                            className={`chapter-chip ${i === ch ? 'active' : ''}`}
                            onClick={() => goChapter(i)}
                            title={c.title}
                        >
                            {c.title}
                        </button>
                    ))}
                </div>
            </div>
        </div>
    );
}
